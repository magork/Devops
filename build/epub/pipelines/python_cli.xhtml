<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2. Python CLI</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/epub.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/max_width.css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="python-cli">
<h1>2. Python CLI</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Python CLI (Command Line Interface) is a type of software application that provides a text-based interface for interacting with the computer’s operating system. The user interacts with the application using a terminal or command prompt, typing commands and receiving output in text form.</p>
</div>
<p>Python is a popular language for developing CLIs because of its simplicity, readability, and powerful libraries. With Python, you can quickly create a CLI that provides a convenient way to automate tasks, access data, or control other software applications.</p>
<p>A Python CLI typically consists of the following components:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Argument parsing: The CLI takes user-supplied input in the form of command-line arguments, which are passed to the program when it is executed. A library such as argparse or click is used to parse these arguments and extract meaningful information from them.</p></li>
<li><p>Main logic: The main logic of the CLI is written in Python and implements the desired functionality. This logic can include reading and writing files, making API calls, or performing calculations.</p></li>
<li><p>Output: The CLI provides output in the form of text printed to the terminal. This output can be formatted in various ways to provide information to the user or to be consumed by other programs.</p></li>
</ol>
</div></blockquote>
<p>By using Python to create a CLI, you can provide a convenient and efficient interface for performing tasks and accessing information. Whether you’re automating a workflow, analyzing data, or controlling a system, a Python CLI can be an effective tool.</p>
<section id="code">
<h2>Code</h2>
<p>A Python CLI that uses the Click library to print a random string:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Simple program that generates a random string based on the selected length.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">click</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;--string_length&quot;</span><span class="p">,</span> <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of characters.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">random_string</span><span class="p">(</span><span class="n">string_length</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple function that generates a random string based on the selected length.&quot;&quot;&quot;</span>
    <span class="n">random_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">string_length</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">random_str</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">random_string</span><span class="p">()</span>
</pre></div>
</div>
<p>This CLI uses the <code class="docutils literal notranslate"><span class="pre">click</span></code> library to create a command-line interface. The <code class="docutils literal notranslate"><span class="pre">click.command</span> <span class="pre">``decorator</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">define</span> <span class="pre">the</span> <span class="pre">``random_string</span></code> function as a command-line command.
The <code class="docutils literal notranslate"><span class="pre">random_string</span></code> function generates a random string using the <code class="docutils literal notranslate"><span class="pre">random.choices</span></code> method from the random module, which selects 10 random characters from a string composed of letters and digits.
The <code class="docutils literal notranslate"><span class="pre">click.echo</span></code> function is then used to print the random string to the console.</p>
</section>
<section id="building-code">
<h2>Building code</h2>
<p>Building code in Python refers to the process of writing, testing, and packaging software written in the Python programming language. The following steps are involved in building code in Python:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Write the code: The first step in building code in Python is writing the code itself. This involves writing the desired functionality in Python, using the language’s syntax and libraries.</p></li>
<li><p>Test the code: Once the code has been written, it is important to test it to ensure that it behaves as expected. This can involve writing unit tests, integration tests, or end-to-end tests to verify the code’s behavior.</p></li>
<li><p>Package the code: If the code is intended to be used by others, it is typically packaged into a distribution package, such as a .tar.gz file, which makes it easy to distribute and install.</p></li>
<li><p>Deploy the code: Finally, the code can be deployed, either to a production environment, such as a web server or a cloud instance or to a development environment, such as a local machine or a virtual environment, for testing and development.</p></li>
</ol>
</div></blockquote>
<p>Building code in Python is made easy by the language’s simplicity, readability, and powerful libraries. With the right tools and processes in place, you can quickly and easily build and deploy robust, scalable code in Python.</p>
<p>An example of a <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file that installs the previous Python CLI code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span><span class="p">,</span> <span class="n">find_packages</span>

<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;random_string_cli&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;0.1&#39;</span><span class="p">,</span>
    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;click&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;random_string_cli = cli.random_string_cli:random_string&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file is used to package and distribute the Python CLI as a package that can be installed using the <code class="docutils literal notranslate"><span class="pre">pip</span></code> package manager.
The <code class="docutils literal notranslate"><span class="pre">setup</span></code> function is used to define the package details, including the name, version, and dependencies. The <code class="docutils literal notranslate"><span class="pre">install_requires</span></code> parameter is used to specify the required dependencies, in this case, the <code class="docutils literal notranslate"><span class="pre">click</span></code> library.
The <code class="docutils literal notranslate"><span class="pre">entry_points</span></code> parameter is used to define the console scripts, which are command-line executables that can be installed and run as standalone commands. In this example, the random_string function from the random_string_cli package is defined as a console script with the name random_string.</p>
</section>
<section id="building-code-with-poetry">
<h2>Building code with poetry</h2>
<p>To build the above Python CLI using the poetry package management and build tool, you would need to follow these steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Install poetry: If you don’t already have poetry installed, you can install it using pip by running the command pip install poetry.</p></li>
<li><p>Initialize a new poetry project: Navigate to the directory where you want to create your new project and run the command poetry init. This will create a new poetry project and generate a pyproject.toml file.</p></li>
<li><p>Add dependencies: In this case, you will need to add the click library as a dependency. You can do this by adding the following line to your pyproject.toml file:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">project</span><span class="p">]</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;random_string_cli&quot;</span>
<span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;0.0.2&quot;</span>
<span class="n">license</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;LICENSE&quot;</span><span class="p">}</span>
<span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;A small python cli that generates a random string&quot;</span>
<span class="n">authors</span> <span class="o">=</span> <span class="p">[{</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;skillab&quot;</span><span class="p">,</span> <span class="n">email</span> <span class="o">=</span> <span class="s2">&quot;admin@skillab.com&quot;</span><span class="p">}]</span>

<span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;click&quot;</span><span class="p">]</span>
<span class="n">requires</span><span class="o">-</span><span class="n">python</span> <span class="o">=</span> <span class="s2">&quot;&gt;=3.10&quot;</span>

<span class="p">[</span><span class="n">project</span><span class="o">.</span><span class="n">scripts</span><span class="p">]</span>
<span class="n">random_string_cli</span> <span class="o">=</span> <span class="s2">&quot;cli.random_string_cli:random_string&quot;</span>

<span class="p">[</span><span class="n">build</span><span class="o">-</span><span class="n">system</span><span class="p">]</span>
<span class="n">requires</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;setuptools&gt;=50&quot;</span><span class="p">,</span> <span class="s2">&quot;wheel&quot;</span><span class="p">]</span>
<span class="n">build</span><span class="o">-</span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;setuptools.build_meta&quot;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Write your code: Write the code for your CLI in a new Python file, making sure to import click and use it to create your command line interface.</p></li>
<li><p>Package your code: Use the poetry build command to package your code into a distribution package that can be installed by others.</p></li>
<li><p>Install and run your CLI: You can now install your CLI using the poetry install command, and run it by executing the appropriate command in your terminal.</p></li>
</ol>
</div></blockquote>
<p>By using poetry to manage your dependencies and build your code, you can streamline your development process and ensure that your code is easily installed and run by others.</p>
</section>
<section id="testing-code">
<h2>Testing code</h2>
<p>PyTest is a testing framework for Python that makes it easy to write and run tests for your code. The basic structure of a test written using PyTest is as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Write a test function: A test function is a Python function that verifies the behavior of a specific piece of code. The test function uses the assert statement to verify that the code under the test behaves as expected.</p></li>
<li><p>Name the test function: PyTest automatically discovers and executes test functions whose names start with <code class="docutils literal notranslate"><span class="pre">test_</span></code>.</p></li>
<li><p>Run PyTest: To run PyTest, simply execute the pytest command in the directory containing your test functions. PyTest will discover and run all test functions, reporting any failures or errors.</p></li>
<li><p>Verify test results: PyTest will report the results of the tests, indicating which tests passed and which tests failed. If a test fails, PyTest will report the values of the actual and expected results.</p></li>
</ol>
</div></blockquote>
<p>In general, PyTest makes it easy to write tests for your code by providing a simple, expressive syntax and powerful test discovery and execution features. By using PyTest, you can quickly and easily verify the behavior of your code, ensuring that changes and additions do not break existing functionality.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">click.testing</span> <span class="kn">import</span> <span class="n">CliRunner</span>
<span class="kn">from</span> <span class="nn">cli.random_string_cli</span> <span class="kn">import</span> <span class="n">random_string</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">CliRunner</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">test_random_string</span><span class="p">():</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="n">random_string</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span><span class="o">.</span><span class="n">exit_code</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">==</span> <span class="mi">10</span>
</pre></div>
</div>
<p>This test uses <code class="docutils literal notranslate"><span class="pre">PyTest</span></code> to test the random_string function from the random_string_cli module. The test function, test_random_string, uses the assert statement to verify that the result is a string, that its length is 10, and that it only contains characters from the set of letters and digits. PyTest automatically discovers and executes this test function when you run the pytest command in the same directory as this file. If any of the assert statements fail, PyTest will report the failure, including information about the values that were expected and actual.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>